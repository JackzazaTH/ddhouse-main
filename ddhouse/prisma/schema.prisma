// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

// 1. Site Configuration (Singleton - ID 1)
model SiteInfo {
  id                Int      @id @default(1)
  siteName          String
  siteTagline       String?
  logoUrl           String?
  phone             String
  officeHours       String
  promoFormImageUrl String
  
  // JSON fields for nested objects
  socials           Json
  buttonLabels      Json
  globalSeo         Json
  serviceArea       Json
}

// 2. Home Designs
model HomeDesign {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  name        String
  description String
  area        Float
  bedrooms    Int
  bathrooms   Int
  parking     Int?
  images      String[] // Array of image URLs
  isFeatured  Boolean  @default(false)

  // Pricing & Promotion
  promotion_enabled          Boolean @default(false)
  discount_percentage        Int?
  price_popular_original     Float?
  price_popular_discounted   Float?
  price_signature_original   Float?
  price_signature_discounted Float?

  seo Json?
}

// 3. Banners
model Banner {
  id        String   @id @default(cuid())
  imageUrl  String
  createdAt DateTime @default(now())
}

// 4. Articles / Blogs
model Article {
  id            String   @id @default(cuid())
  slug          String   @unique
  title         String
  content       String   @db.Text
  excerpt       String
  imageUrl      String
  author        String
  publishedDate String   // Storing as String YYYY-MM-DD to match frontend
  tags          String[]
  seo           Json?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

// 5. Portfolio Projects
model PortfolioProject {
  id          String   @id @default(cuid())
  slug        String   @unique
  title       String
  category    String
  coverImage  String
  images      String[]
  description String   @db.Text
  location    String
  area        Float
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// 6. Custom Pages
model CustomPage {
  id           String   @id @default(cuid())
  slug         String   @unique
  title        String
  content      String   @db.Text
  imageUrl     String?
  menuLocation String   @default("service_submenu") // 'primary', 'service_submenu', 'none'
  order        Int      @default(0)
  seo          Json?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

// 7. Marketing & Leads
model Lead {
  id               String   @id @default(cuid())
  firstName        String
  lastName         String
  phone            String
  email            String
  landSize         Float
  province         String
  district         String
  budget           Float
  constructionDate String
  timestamp        DateTime @default(now())
  status           String   @default("New") // New, Contacted, Follow-up, Closed
  notes            String?
}

model PromoCard {
  id        String   @id @default(cuid())
  title     String
  subtitle  String?
  imageUrl  String
  linkType  String   @default("page")
  linkValue String
  size      String   @default("1x1")
  order     Int      @default(0)
}

model Testimonial {
  id         String   @id @default(cuid())
  title      String
  imageUrl   String
  videoUrl   String
  order      Int      @default(0)
  isFeatured Boolean  @default(false)
}

model SiteNotification {
  id        String  @id @default(cuid())
  message   String
  isActive  Boolean @default(false)
  link      String?
  linkLabel String?
}

model PopupModalContent {
  id          Int     @id @default(1) // Singleton
  isEnabled   Boolean @default(true)
  imageUrl    String
  title       String
  description String
  ctaText     String
  linkType    String
  linkValue   String
}

// 8. System Logs
model LoginLog {
  id        String   @id @default(cuid())
  username  String
  timestamp DateTime @default(now())
  status    String
  ip        String?
}